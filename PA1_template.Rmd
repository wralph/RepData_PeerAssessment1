---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data
```{r echo=TRUE}
library(dplyr, quietly = TRUE, warn.conflicts = FALSE)
library(ggplot2)
library(scales)

zipfile <- "activity.zip"
if(!file.exists(zipfile)) 
{
  print("error: file does not exist")
}
data <- tbl_df(read.csv(unz(zipfile, "activity.csv"), 
                  col.names=c("steps", "date", "interval"),
                  colClasses=c("numeric", "POSIXct", "numeric"),
                  stringsAsFactors=FALSE, 
                  header=TRUE))
#data <- data.raw %>% filter(!is.na(steps))

# freeing some memory
#rm(data.raw)
rm(zipfile)

str(data)
```


## What is mean total number of steps taken per day?

1. Calculate the total number of steps taken per day
```{r echo=TRUE}
totalStepsPerDay <- data %>% filter(!is.na(steps)) %>% group_by(date) %>% summarize(tot = sum(steps))
totalStepsPerDay
```

2. If you do not understand the difference between a histogram and a barplot, research the difference between them. Make a histogram of the total number of steps taken each day

```{r echo=TRUE}
#totalStepsPerDay <- data %>% group_by(date) %>% summarize(tot = sum(steps))

ggplot(totalStepsPerDay, aes(date)) +
      geom_histogram(alpha=1/4) +
      labs(title = "Total number of steps taken per day") +
      labs(x = "Day", y = "# of Steps") +
      scale_y_continuous(labels = comma)

rm(totalStepsPerDay)
```



3. Calculate and report the mean and median of the total number of steps taken per day

### Mean
```{r echo=TRUE}
meanStepsPerDay <- data %>% filter(!is.na(steps)) %>% group_by(date) %>% summarize(mn = mean(steps))
ggplot(meanStepsPerDay, aes(date, mn)) +
      geom_line(size=2, alpha=1/4) +
      geom_point(size = 4, alpha = 1/2)  +	
      labs(title = "Mean number of steps taken per day") +
      labs(x = "Day", y = "Mean # of Steps")

rm(meanStepsPerDay)
```


### Median
```{r echo=TRUE}
medianStepsPerDay <- data %>% filter(!is.na(steps) & steps > 0) %>% group_by(date) %>% summarize(mn = median(steps))
ggplot(medianStepsPerDay, aes(date, mn)) +
      geom_line(size=2, alpha=1/4) +
      geom_point(size = 4, alpha = 1/2)  +  
      labs(title = "Median number of steps taken per day") +
      labs(x = "Day", y = "Median # of Steps")

rm(medianStepsPerDay)
```

## What is the average daily activity pattern?


1.Make a time series plot (i.e. type = "l") of the 5-minute interval (x-axis) and the average number of steps taken, averaged across all days (y-axis)
```{r echo=TRUE}
averageSteps <- data %>% filter(!is.na(steps)) %>% group_by(interval) %>% summarize(mn = mean(steps))
ggplot(averageSteps, aes(interval, mn)) +
      geom_line(size=2, alpha=1/4) +
      geom_point(size = 2, alpha = 1/2)  +  
      labs(title = "Mean number of steps taken per inteval") +
      labs(x = "Interval", y = "Mean # of Steps")

rm(averageSteps)
```

2.Which 5-minute interval, on average across all the days in the dataset, contains the maximum number of steps?
```{r echo=TRUE}
data %>% filter(!is.na(steps)) %>% group_by(interval) %>% summarize(sm = sum(steps)) %>% top_n(1)
```


## Imputing missing values

```{r echo=TRUE}
```

## Are there differences in activity patterns between weekdays and weekends?
